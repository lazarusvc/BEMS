@inject AuthenticationStateProvider authStateProvider;
@using DataAccessLibrary.Models;
@using DataAccessLibrary;
@inject IDbData _db;

<div class="card">
    <div class="card-body">
      <div class="card-header">
    <h5 class="card-title">My Programs</h5>
  </div>
    
      <ul class="list-group list-group-flush">
          
        @if (accessTo is null || accessTo.Count==0)
        {
           <li class="list-group-item">No access yet</li>
        }
        else {
             @foreach (var item in accessTo)
            {
                <li class="list-group-item"><a href="/recurrent/@year/@item.Id/@item.Name"><b>@item.Name</b></a> @item.Description</li>
            }
        }
      </ul>
  </div>
</div>

@code {
    [Parameter]
    public int year { get; set; }

    private List<ListItemModel2> accessTo;
    private string username;

    protected override async Task OnInitializedAsync()
    {
        var authState = await authStateProvider.GetAuthenticationStateAsync();
        username = authState.User.Identity.Name;
        accessTo =  await _db.GetUserMinPrograms(username);
    }




}
